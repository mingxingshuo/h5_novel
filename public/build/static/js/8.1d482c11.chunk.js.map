{"version":3,"sources":["pages/channel/edit/index.js"],"names":["EditChannel","_this","this","_this$props","props","title","official","changeChannelInput","changeGonghaoInput","uploadImage","handleCreate","handleUpdate","location","uploadProps","action","api","onChange","showUploadList","name","submit","search","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","antd__WEBPACK_IMPORTED_MODULE_7__","style","marginRight","type","onClick","antd__WEBPACK_IMPORTED_MODULE_8__","labelCol","sm","span","wrapperCol","Item","label","antd__WEBPACK_IMPORTED_MODULE_9__","value","placeholder","antd__WEBPACK_IMPORTED_MODULE_10__","image","antd__WEBPACK_IMPORTED_MODULE_11__","width","src","alt","marginLeft","history","goBack","data","decodeURI","JSON","parse","split","initState","resetState","PureComponent","connect","state","channel","id","dispatch","e","target","actionCreators","res","file","status","response","image_url","withRouter"],"mappings":"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","file":"static/js/8.1d482c11.chunk.js","sourcesContent":["import React, {PureComponent} from 'react';\r\nimport { connect } from \"react-redux\";\r\nimport {Form, Input, Button, Upload, Icon} from \"antd\";\r\nimport { actionCreators } from '../store';\r\nimport { api } from '../../../api/config';\r\nimport { withRouter } from 'react-router-dom';\r\n\r\nclass EditChannel extends PureComponent {\r\n  render() {\r\n    const { title, official, changeChannelInput, changeGonghaoInput, uploadImage, handleCreate, handleUpdate, location } = this.props;\r\n    const FormLabelCol = {\r\n      labelCol: {\r\n        sm: {span: 3},\r\n      },\r\n      wrapperCol: {\r\n        sm: {span: 8},\r\n      }\r\n    };\r\n    const uploadProps = {\r\n      action: api + '/distribution/upload',\r\n      onChange: uploadImage,\r\n      showUploadList: false,\r\n      name: 'imageFile'\r\n    };\r\n\r\n    let submit = !location.search ? <Button style={{marginRight: '20px'}} type='primary' onClick={() => {handleCreate(this.props)}}>创建</Button> : <Button style={{marginRight: '20px'}} type='primary' onClick={() => {handleUpdate(this.props)}}>修改</Button>;\r\n\r\n    return (\r\n      <Form {...FormLabelCol}>\r\n        <Form.Item label='渠道名称'>\r\n          <Input value={title} onChange={changeChannelInput} placeholder='请输入渠道名称'/>\r\n        </Form.Item>\r\n        <Form.Item label='公号名称'>\r\n          <Input value={official.name} onChange={changeGonghaoInput} placeholder='请输入公号名称'/>\r\n        </Form.Item>\r\n        <Form.Item label='公号图片'>\r\n          <Upload {...uploadProps}>\r\n            {official.image === ''\r\n              ? (<Button><Icon type=\"upload\" />上传图片</Button>)\r\n              : (<img style={{width: '200px'}} src={official.image} alt=\"\"/>)}\r\n          </Upload>\r\n        </Form.Item>\r\n        <Form.Item style={{marginLeft: '100px'}}>\r\n          {submit}\r\n          <Button type='danger' onClick={() => this.props.history.goBack()}>取消</Button>\r\n        </Form.Item>\r\n      </Form>\r\n    );\r\n  }\r\n  componentDidMount() {\r\n    if(this.props.location.search) {\r\n      let data = decodeURI(this.props.location.search);\r\n      data = JSON.parse(data.split('=')[1]);\r\n      this.props.initState(data)\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.props.resetState()\r\n  }\r\n}\r\n\r\nconst mapState = (state) => ({\r\n  title: state.channel.title,\r\n  official: state.channel.official,\r\n  id: state.channel.id\r\n});\r\n\r\nconst mapDispatch = (dispatch) => ({\r\n  changeChannelInput(e) {\r\n    let title = e.target.value;\r\n    dispatch(actionCreators.changeChannelInput(title))\r\n  },\r\n  changeGonghaoInput(e) {\r\n    let name = e.target.value;\r\n    dispatch(actionCreators.changeGonghaoInput(name))\r\n  },\r\n  uploadImage(res) {\r\n    if(res.file.status === 'done') {\r\n      let image = api + '/distributions/' + res.file.response.image_url;\r\n      dispatch(actionCreators.uploadImage(image))\r\n    }\r\n  },\r\n  handleCreate(props) {\r\n    dispatch(actionCreators.handleCreate(props))\r\n  },\r\n  initState(data) {\r\n    dispatch(actionCreators.initState(data))\r\n  },\r\n  handleUpdate(props) {\r\n    dispatch(actionCreators.handleUpdate(props))\r\n  },\r\n  resetState() {\r\n    dispatch(actionCreators.resetState())\r\n  }\r\n});\r\n\r\nexport default connect(mapState, mapDispatch)(withRouter(EditChannel));"],"sourceRoot":""}